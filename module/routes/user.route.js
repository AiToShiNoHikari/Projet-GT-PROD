const e=require("express"),s=require("../database/index.model"),{uuid:r}=require("uuidv4"),t=require("../function/pwGestion.fn"),u=require("../function/rigthGestion.fn");let i=e.Router();i.get("/",(function(e,r){s.User.findAll().then(e=>{e=e.map(e=>({idUser:e.idUser,userLastName:e.userLastName,userFirstName:e.userFirstName,userRight:e.userRight})),r.json(e)}).catch(e=>{r.status(400),r.json(e)})})),i.get("/who",(function(e,s){s.json({idUser:e.user.idUser,userLastName:e.user.userLastName,userFirstName:e.user.userFirstName,userRight:e.user.userRight})})),i.post("/",u.filter("createUser"),(function(e,i){let a={idUser:r(),userLastName:e.body.userLastName,userFirstName:e.body.userFirstName,userLogin:e.body.userLogin,userRight:0==e.token.indexOf("temp_")?u.rigth("admin"):e.body.userRight};a.userHash=t.fHashPW(e.body.userPassword,a),s.User.create(a).then(e=>{i.json({idUser:e.idUser,userLastName:e.userLastName,userFirstName:e.userFirstName,userLogin:e.userLogin,userRight:e.userRight})}).catch(e=>{i.status(400),i.json(e)})})),module.exports=i;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS9yb3V0ZXMvdXNlci5yb3V0ZS5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImRiIiwidXVpZCIsImxvUHdHZXN0aW9uIiwibG9SaWd0aEdlc3Rpb24iLCJsb1JvdXRlciIsIlJvdXRlciIsImdldCIsInJlcSIsInJlcyIsIlVzZXIiLCJmaW5kQWxsIiwidGhlbiIsInBvVXNlcnMiLCJtYXAiLCJwb1VzZXIiLCJpZFVzZXIiLCJ1c2VyTGFzdE5hbWUiLCJ1c2VyRmlyc3ROYW1lIiwidXNlclJpZ2h0IiwianNvbiIsImNhdGNoIiwicGFFcnJvciIsInN0YXR1cyIsInVzZXIiLCJwb3N0IiwiZmlsdGVyIiwibG9Vc2VyIiwiYm9keSIsInVzZXJMb2dpbiIsInRva2VuIiwiaW5kZXhPZiIsInJpZ3RoIiwidXNlckhhc2giLCJmSGFzaFBXIiwidXNlclBhc3N3b3JkIiwiY3JlYXRlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsRUFBVUMsUUFBUSxXQUNsQkMsRUFBS0QsUUFBUSw0QkFDYkUsS0FDSkEsR0FDRUYsUUFBUSxVQUVORyxFQUFjSCxRQUFRLDRCQUN0QkksRUFBaUJKLFFBQVEsK0JBRS9CLElBQUlLLEVBQVdOLEVBQVFPLFNBRXZCRCxFQUFTRSxJQUFJLEtBQUssU0FBU0MsRUFBS0MsR0FDOUJSLEVBQUdTLEtBQUtDLFVBQVVDLEtBQU1DLElBQ3BCQSxFQUFVQSxFQUFRQyxJQUFJQyxJQUNiLENBQ0xDLE9BQVFELEVBQU9DLE9BQ2ZDLGFBQWNGLEVBQU9FLGFBQ3JCQyxjQUFlSCxFQUFPRyxjQUN0QkMsVUFBV0osRUFBT0ksYUFHdEJWLEVBQUlXLEtBQUtQLEtBRVZRLE1BQU1DLElBQ0xiLEVBQUljLE9BQU8sS0FDWGQsRUFBSVcsS0FBS0UsUUFJZmpCLEVBQVNFLElBQUksUUFBUSxTQUFTQyxFQUFLQyxHQUNqQ0EsRUFBSVcsS0FBSyxDQUNQSixPQUFRUixFQUFJZ0IsS0FBS1IsT0FDakJDLGFBQWNULEVBQUlnQixLQUFLUCxhQUN2QkMsY0FBZVYsRUFBSWdCLEtBQUtOLGNBQ3hCQyxVQUFXWCxFQUFJZ0IsS0FBS0wsZUFJeEJkLEVBQVNvQixLQUFLLElBQUtyQixFQUFlc0IsT0FBTyxlQUFlLFNBQVNsQixFQUFLQyxHQUNwRSxJQUFJa0IsRUFBUyxDQUNYWCxPQUFRZCxJQUNSZSxhQUFjVCxFQUFJb0IsS0FBS1gsYUFDdkJDLGNBQWVWLEVBQUlvQixLQUFLVixjQUN4QlcsVUFBV3JCLEVBQUlvQixLQUFLQyxVQUNwQlYsVUFBeUMsR0FBOUJYLEVBQUlzQixNQUFNQyxRQUFRLFNBQWdCM0IsRUFBZTRCLE1BQU0sU0FBV3hCLEVBQUlvQixLQUFLVCxXQUd4RlEsRUFBT00sU0FBVzlCLEVBQVkrQixRQUFRMUIsRUFBSW9CLEtBQUtPLGFBQWNSLEdBRTdEMUIsRUFBR1MsS0FBSzBCLE9BQU9ULEdBQ1pmLEtBQUtHLElBQ0pOLEVBQUlXLEtBQUssQ0FDUEosT0FBUUQsRUFBT0MsT0FDZkMsYUFBY0YsRUFBT0UsYUFDckJDLGNBQWVILEVBQU9HLGNBQ3RCVyxVQUFXZCxFQUFPYyxVQUNsQlYsVUFBV0osRUFBT0ksY0FHckJFLE1BQU1DLElBQ0xiLEVBQUljLE9BQU8sS0FDWGQsRUFBSVcsS0FBS0UsUUFLZmUsT0FBT0MsUUFBVWpDIiwiZmlsZSI6Im1vZHVsZS9yb3V0ZXMvdXNlci5yb3V0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBkYiA9IHJlcXVpcmUoJy4uL2RhdGFiYXNlL2luZGV4Lm1vZGVsJyk7XG5jb25zdCB7XG4gIHV1aWRcbn0gPSByZXF1aXJlKCd1dWlkdjQnKTtcblxuY29uc3QgbG9Qd0dlc3Rpb24gPSByZXF1aXJlKCcuLi9mdW5jdGlvbi9wd0dlc3Rpb24uZm4nKTtcbmNvbnN0IGxvUmlndGhHZXN0aW9uID0gcmVxdWlyZSgnLi4vZnVuY3Rpb24vcmlndGhHZXN0aW9uLmZuJyk7XG5cbmxldCBsb1JvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5cbmxvUm91dGVyLmdldCgnLycsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gIGRiLlVzZXIuZmluZEFsbCgpLnRoZW4oKHBvVXNlcnMpID0+IHtcbiAgICAgIHBvVXNlcnMgPSBwb1VzZXJzLm1hcChwb1VzZXIgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkVXNlcjogcG9Vc2VyLmlkVXNlcixcbiAgICAgICAgICB1c2VyTGFzdE5hbWU6IHBvVXNlci51c2VyTGFzdE5hbWUsXG4gICAgICAgICAgdXNlckZpcnN0TmFtZTogcG9Vc2VyLnVzZXJGaXJzdE5hbWUsXG4gICAgICAgICAgdXNlclJpZ2h0OiBwb1VzZXIudXNlclJpZ2h0XG4gICAgICAgIH07XG4gICAgICB9KVxuICAgICAgcmVzLmpzb24ocG9Vc2Vycyk7XG4gICAgfSlcbiAgICAuY2F0Y2gocGFFcnJvciA9PiB7XG4gICAgICByZXMuc3RhdHVzKDQwMClcbiAgICAgIHJlcy5qc29uKHBhRXJyb3IpO1xuICAgIH0pXG59KTtcblxubG9Sb3V0ZXIuZ2V0KCcvd2hvJywgZnVuY3Rpb24ocmVxLCByZXMpIHtcbiAgcmVzLmpzb24oe1xuICAgIGlkVXNlcjogcmVxLnVzZXIuaWRVc2VyLFxuICAgIHVzZXJMYXN0TmFtZTogcmVxLnVzZXIudXNlckxhc3ROYW1lLFxuICAgIHVzZXJGaXJzdE5hbWU6IHJlcS51c2VyLnVzZXJGaXJzdE5hbWUsXG4gICAgdXNlclJpZ2h0OiByZXEudXNlci51c2VyUmlnaHRcbiAgfSk7XG59KTtcblxubG9Sb3V0ZXIucG9zdCgnLycsIGxvUmlndGhHZXN0aW9uLmZpbHRlcignY3JlYXRlVXNlcicpLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICBsZXQgbG9Vc2VyID0ge1xuICAgIGlkVXNlcjogdXVpZCgpLFxuICAgIHVzZXJMYXN0TmFtZTogcmVxLmJvZHkudXNlckxhc3ROYW1lLFxuICAgIHVzZXJGaXJzdE5hbWU6IHJlcS5ib2R5LnVzZXJGaXJzdE5hbWUsXG4gICAgdXNlckxvZ2luOiByZXEuYm9keS51c2VyTG9naW4sXG4gICAgdXNlclJpZ2h0OiByZXEudG9rZW4uaW5kZXhPZigndGVtcF8nKSA9PSAwID8gbG9SaWd0aEdlc3Rpb24ucmlndGgoJ2FkbWluJykgOiByZXEuYm9keS51c2VyUmlnaHQsXG4gIH1cblxuICBsb1VzZXIudXNlckhhc2ggPSBsb1B3R2VzdGlvbi5mSGFzaFBXKHJlcS5ib2R5LnVzZXJQYXNzd29yZCwgbG9Vc2VyKVxuXG4gIGRiLlVzZXIuY3JlYXRlKGxvVXNlcilcbiAgICAudGhlbihwb1VzZXIgPT4ge1xuICAgICAgcmVzLmpzb24oe1xuICAgICAgICBpZFVzZXI6IHBvVXNlci5pZFVzZXIsXG4gICAgICAgIHVzZXJMYXN0TmFtZTogcG9Vc2VyLnVzZXJMYXN0TmFtZSxcbiAgICAgICAgdXNlckZpcnN0TmFtZTogcG9Vc2VyLnVzZXJGaXJzdE5hbWUsXG4gICAgICAgIHVzZXJMb2dpbjogcG9Vc2VyLnVzZXJMb2dpbixcbiAgICAgICAgdXNlclJpZ2h0OiBwb1VzZXIudXNlclJpZ2h0LFxuICAgICAgfSk7XG4gICAgfSlcbiAgICAuY2F0Y2gocGFFcnJvciA9PiB7XG4gICAgICByZXMuc3RhdHVzKDQwMClcbiAgICAgIHJlcy5qc29uKHBhRXJyb3IpO1xuICAgIH0pXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGxvUm91dGVyXG4iXX0=
