const e=require("express"),s=require("../database/index.model"),{uuid:r}=require("uuidv4"),t=require("../function/pwGestion.fn"),i=require("../function/rigthGestion.fn");let u=e.Router();u.get("/",(function(e,r){s.User.findAll().then(e=>{e=e.map(e=>({idUser:e.idUser,userLastName:e.userLastName,userFirstName:e.userFirstName,userRight:e.userRight})),r.json(e)}).catch(e=>{r.status(400),r.json(e)})})),u.post("/",i.filter("createUser"),(function(e,u){let a={idUser:r(),userLastName:e.body.userLastName,userFirstName:e.body.userFirstName,userLogin:e.body.userLogin,userRight:0==e.token.indexOf("temp_")?i.rigth("admin"):e.body.userRight};a.userHash=t.fHashPW(e.body.userPassword,a),s.User.create(a).then(e=>{u.json({idUser:e.idUser,userLastName:e.userLastName,userFirstName:e.userFirstName,userLogin:e.userLogin,userRight:e.userRight})}).catch(e=>{u.status(400),u.json(e)})})),module.exports=u;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS9yb3V0ZXMvdXNlci5yb3V0ZS5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImRiIiwidXVpZCIsImxvUHdHZXN0aW9uIiwibG9SaWd0aEdlc3Rpb24iLCJsb1JvdXRlciIsIlJvdXRlciIsImdldCIsInJlcSIsInJlcyIsIlVzZXIiLCJmaW5kQWxsIiwidGhlbiIsInBvVXNlcnMiLCJtYXAiLCJwb1VzZXIiLCJpZFVzZXIiLCJ1c2VyTGFzdE5hbWUiLCJ1c2VyRmlyc3ROYW1lIiwidXNlclJpZ2h0IiwianNvbiIsImNhdGNoIiwicGFFcnJvciIsInN0YXR1cyIsInBvc3QiLCJmaWx0ZXIiLCJsb1VzZXIiLCJib2R5IiwidXNlckxvZ2luIiwidG9rZW4iLCJpbmRleE9mIiwicmlndGgiLCJ1c2VySGFzaCIsImZIYXNoUFciLCJ1c2VyUGFzc3dvcmQiLCJjcmVhdGUiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxFQUFVQyxRQUFRLFdBQ2xCQyxFQUFLRCxRQUFRLDRCQUNiRSxLQUNKQSxHQUNFRixRQUFRLFVBRU5HLEVBQWNILFFBQVEsNEJBQ3RCSSxFQUFpQkosUUFBUSwrQkFFL0IsSUFBSUssRUFBV04sRUFBUU8sU0FFdkJELEVBQVNFLElBQUksS0FBSyxTQUFTQyxFQUFLQyxHQUM5QlIsRUFBR1MsS0FBS0MsVUFBVUMsS0FBTUMsSUFDcEJBLEVBQVVBLEVBQVFDLElBQUlDLElBQ2IsQ0FDTEMsT0FBUUQsRUFBT0MsT0FDZkMsYUFBY0YsRUFBT0UsYUFDckJDLGNBQWVILEVBQU9HLGNBQ3RCQyxVQUFXSixFQUFPSSxhQUd0QlYsRUFBSVcsS0FBS1AsS0FFVlEsTUFBTUMsSUFDTGIsRUFBSWMsT0FBTyxLQUNYZCxFQUFJVyxLQUFLRSxRQUlmakIsRUFBU21CLEtBQUssSUFBS3BCLEVBQWVxQixPQUFPLGVBQWUsU0FBU2pCLEVBQUtDLEdBQ3BFLElBQUlpQixFQUFTLENBQ1hWLE9BQVFkLElBQ1JlLGFBQWNULEVBQUltQixLQUFLVixhQUN2QkMsY0FBZVYsRUFBSW1CLEtBQUtULGNBQ3hCVSxVQUFXcEIsRUFBSW1CLEtBQUtDLFVBQ3BCVCxVQUF5QyxHQUE5QlgsRUFBSXFCLE1BQU1DLFFBQVEsU0FBZ0IxQixFQUFlMkIsTUFBTSxTQUFXdkIsRUFBSW1CLEtBQUtSLFdBR3hGTyxFQUFPTSxTQUFXN0IsRUFBWThCLFFBQVF6QixFQUFJbUIsS0FBS08sYUFBY1IsR0FFN0R6QixFQUFHUyxLQUFLeUIsT0FBT1QsR0FDWmQsS0FBS0csSUFDSk4sRUFBSVcsS0FBSyxDQUNQSixPQUFRRCxFQUFPQyxPQUNmQyxhQUFjRixFQUFPRSxhQUNyQkMsY0FBZUgsRUFBT0csY0FDdEJVLFVBQVdiLEVBQU9hLFVBQ2xCVCxVQUFXSixFQUFPSSxjQUdyQkUsTUFBTUMsSUFDTGIsRUFBSWMsT0FBTyxLQUNYZCxFQUFJVyxLQUFLRSxRQUtmYyxPQUFPQyxRQUFVaEMiLCJmaWxlIjoibW9kdWxlL3JvdXRlcy91c2VyLnJvdXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbmNvbnN0IGRiID0gcmVxdWlyZSgnLi4vZGF0YWJhc2UvaW5kZXgubW9kZWwnKTtcbmNvbnN0IHtcbiAgdXVpZFxufSA9IHJlcXVpcmUoJ3V1aWR2NCcpO1xuXG5jb25zdCBsb1B3R2VzdGlvbiA9IHJlcXVpcmUoJy4uL2Z1bmN0aW9uL3B3R2VzdGlvbi5mbicpO1xuY29uc3QgbG9SaWd0aEdlc3Rpb24gPSByZXF1aXJlKCcuLi9mdW5jdGlvbi9yaWd0aEdlc3Rpb24uZm4nKTtcblxubGV0IGxvUm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcblxubG9Sb3V0ZXIuZ2V0KCcvJywgZnVuY3Rpb24ocmVxLCByZXMpIHtcbiAgZGIuVXNlci5maW5kQWxsKCkudGhlbigocG9Vc2VycykgPT4ge1xuICAgICAgcG9Vc2VycyA9IHBvVXNlcnMubWFwKHBvVXNlciA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWRVc2VyOiBwb1VzZXIuaWRVc2VyLFxuICAgICAgICAgIHVzZXJMYXN0TmFtZTogcG9Vc2VyLnVzZXJMYXN0TmFtZSxcbiAgICAgICAgICB1c2VyRmlyc3ROYW1lOiBwb1VzZXIudXNlckZpcnN0TmFtZSxcbiAgICAgICAgICB1c2VyUmlnaHQ6IHBvVXNlci51c2VyUmlnaHRcbiAgICAgICAgfTtcbiAgICAgIH0pXG4gICAgICByZXMuanNvbihwb1VzZXJzKTtcbiAgICB9KVxuICAgIC5jYXRjaChwYUVycm9yID0+IHtcbiAgICAgIHJlcy5zdGF0dXMoNDAwKVxuICAgICAgcmVzLmpzb24ocGFFcnJvcik7XG4gICAgfSlcbn0pO1xuXG5sb1JvdXRlci5wb3N0KCcvJywgbG9SaWd0aEdlc3Rpb24uZmlsdGVyKCdjcmVhdGVVc2VyJyksIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gIGxldCBsb1VzZXIgPSB7XG4gICAgaWRVc2VyOiB1dWlkKCksXG4gICAgdXNlckxhc3ROYW1lOiByZXEuYm9keS51c2VyTGFzdE5hbWUsXG4gICAgdXNlckZpcnN0TmFtZTogcmVxLmJvZHkudXNlckZpcnN0TmFtZSxcbiAgICB1c2VyTG9naW46IHJlcS5ib2R5LnVzZXJMb2dpbixcbiAgICB1c2VyUmlnaHQ6IHJlcS50b2tlbi5pbmRleE9mKCd0ZW1wXycpID09IDAgPyBsb1JpZ3RoR2VzdGlvbi5yaWd0aCgnYWRtaW4nKSA6IHJlcS5ib2R5LnVzZXJSaWdodCxcbiAgfVxuXG4gIGxvVXNlci51c2VySGFzaCA9IGxvUHdHZXN0aW9uLmZIYXNoUFcocmVxLmJvZHkudXNlclBhc3N3b3JkLCBsb1VzZXIpXG5cbiAgZGIuVXNlci5jcmVhdGUobG9Vc2VyKVxuICAgIC50aGVuKHBvVXNlciA9PiB7XG4gICAgICByZXMuanNvbih7XG4gICAgICAgIGlkVXNlcjogcG9Vc2VyLmlkVXNlcixcbiAgICAgICAgdXNlckxhc3ROYW1lOiBwb1VzZXIudXNlckxhc3ROYW1lLFxuICAgICAgICB1c2VyRmlyc3ROYW1lOiBwb1VzZXIudXNlckZpcnN0TmFtZSxcbiAgICAgICAgdXNlckxvZ2luOiBwb1VzZXIudXNlckxvZ2luLFxuICAgICAgICB1c2VyUmlnaHQ6IHBvVXNlci51c2VyUmlnaHQsXG4gICAgICB9KTtcbiAgICB9KVxuICAgIC5jYXRjaChwYUVycm9yID0+IHtcbiAgICAgIHJlcy5zdGF0dXMoNDAwKVxuICAgICAgcmVzLmpzb24ocGFFcnJvcik7XG4gICAgfSlcblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gbG9Sb3V0ZXJcbiJdfQ==
