const e=require("../error.list");let r=["admin","creator","redactor","reader"];function t(r){r.json({error:e.noAuth})}module.exports={filter:e=>{switch(e){case"createUser":return(e,i,n)=>{if(0==e.token.indexOf("temp_"))n();else switch(r[e.user.userRight]){case"admin":n();break;default:t(i)}};default:return(e,r,t)=>t()}},rigth:e=>r.findIndex(r=>e==r),listRigth:()=>r};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS9mdW5jdGlvbi9yaWd0aEdlc3Rpb24uZm4uanMiXSwibmFtZXMiOlsiZ29FcnJvckxpc3QiLCJyZXF1aXJlIiwiZ3RSaWd0aCIsImZTZW5kQmFkUmlndGgiLCJwUmVzIiwianNvbiIsImVycm9yIiwibm9BdXRoIiwibW9kdWxlIiwiZXhwb3J0cyIsImZpbHRlciIsInBzQWN0aW9uVHlwZSIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImluZGV4T2YiLCJ1c2VyIiwidXNlclJpZ2h0IiwicmlndGgiLCJwc1JpZ3RoIiwiZmluZEluZGV4IiwicHNFIiwibGlzdFJpZ3RoIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxFQUFjQyxRQUFRLGlCQUU1QixJQUFJQyxFQUFVLENBQ1osUUFDQSxVQUNBLFdBQ0EsVUFHRixTQUFTQyxFQUFjQyxHQUNyQkEsRUFBS0MsS0FBSyxDQUNSQyxNQUFPTixFQUFZTyxTQUl2QkMsT0FBT0MsUUFBVSxDQUNmQyxPQUFTQyxJQUNQLE9BQVFBLEdBQ04sSUFBSyxhQUNILE1BQU8sQ0FBQ0MsRUFBS0MsRUFBS0MsS0FDaEIsR0FBa0MsR0FBOUJGLEVBQUlHLE1BQU1DLFFBQVEsU0FDcEJGLFNBRUEsT0FBUVosRUFBUVUsRUFBSUssS0FBS0MsWUFDdkIsSUFBSyxRQUNISixJQUNBLE1BQ0YsUUFDRVgsRUFBY1UsS0FLeEIsUUFDRSxNQUFPLENBQUNELEVBQUtDLEVBQUtDLElBQVNBLE1BR2pDSyxNQUFRQyxHQUFZbEIsRUFBUW1CLFVBQVVDLEdBQU9GLEdBQVdFLEdBQ3hEQyxVQUFXLElBQU1yQiIsImZpbGUiOiJtb2R1bGUvZnVuY3Rpb24vcmlndGhHZXN0aW9uLmZuLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ29FcnJvckxpc3QgPSByZXF1aXJlKCcuLi9lcnJvci5saXN0Jyk7XG5cbmxldCBndFJpZ3RoID0gW1xuICAnYWRtaW4nLFxuICAnY3JlYXRvcicsXG4gICdyZWRhY3RvcicsXG4gICdyZWFkZXInXG5dXG5cbmZ1bmN0aW9uIGZTZW5kQmFkUmlndGgocFJlcykge1xuICBwUmVzLmpzb24oe1xuICAgIGVycm9yOiBnb0Vycm9yTGlzdC5ub0F1dGhcbiAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBmaWx0ZXI6IChwc0FjdGlvblR5cGUpID0+IHtcbiAgICBzd2l0Y2ggKHBzQWN0aW9uVHlwZSkge1xuICAgICAgY2FzZSAnY3JlYXRlVXNlcic6XG4gICAgICAgIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgICAgICBpZiAocmVxLnRva2VuLmluZGV4T2YoJ3RlbXBfJykgPT0gMCkge1xuICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGd0UmlndGhbcmVxLnVzZXIudXNlclJpZ2h0XSkge1xuICAgICAgICAgICAgICBjYXNlICdhZG1pbic6XG4gICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGZTZW5kQmFkUmlndGgocmVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gKHJlcSwgcmVzLCBuZXh0KSA9PiBuZXh0KClcbiAgICB9XG4gIH0sXG4gIHJpZ3RoOiAocHNSaWd0aCkgPT4gZ3RSaWd0aC5maW5kSW5kZXgocHNFID0+IHBzUmlndGggPT0gcHNFKSxcbiAgbGlzdFJpZ3RoOiAoKSA9PiBndFJpZ3RoXG59XG4iXX0=
